// Code generated by client-gen; DO NOT EDIT.

package storage

import (
	"context"
	"fmt"
)

import "github.com/bsv-blockchain/go-wallet-toolbox/pkg/wdk"

// Migrate migrates a wallet storage database.
func (m *WalletStorageManager) Migrate(ctx context.Context, storageName string, storageIdentityKey string) (string, error) {

	return m.getActiveWriter().Migrate(ctx, storageName, storageIdentityKey)
}

// FindOrInsertUser retrieves an existing user or inserts a new one based on the given identity key.
func (m *WalletStorageManager) FindOrInsertUser(ctx context.Context, identityKey string) (*wdk.FindOrInsertUserResponse, error) {

	return m.getActiveWriter().FindOrInsertUser(ctx, identityKey)
}

// InternalizeAction handles the internalization of a transaction from the outside of the wallet.
func (m *WalletStorageManager) InternalizeAction(ctx context.Context, args wdk.InternalizeActionArgs) (*wdk.InternalizeActionResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().InternalizeAction(ctx, auth, args)
}

// CreateAction creates a new transaction ready to be signed and processed later.
func (m *WalletStorageManager) CreateAction(ctx context.Context, args wdk.ValidCreateActionArgs) (*wdk.StorageCreateActionResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().CreateAction(ctx, auth, args)
}

// ProcessAction processes a signed transaction created by CreateAction.
func (m *WalletStorageManager) ProcessAction(ctx context.Context, args wdk.ProcessActionArgs) (*wdk.ProcessActionResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().ProcessAction(ctx, auth, args)
}

// InsertCertificateAuth adds a new certificate for a user.
func (m *WalletStorageManager) InsertCertificateAuth(ctx context.Context, certificate *wdk.TableCertificateX) (uint, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return 0, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().InsertCertificateAuth(ctx, auth, certificate)
}

// RelinquishCertificate revokes the specified certificate from the users certificates.
func (m *WalletStorageManager) RelinquishCertificate(ctx context.Context, args wdk.RelinquishCertificateArgs) error {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().RelinquishCertificate(ctx, auth, args)
}

// RelinquishOutput removes the specified output from the users outputs.
func (m *WalletStorageManager) RelinquishOutput(ctx context.Context, args wdk.RelinquishOutputArgs) error {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().RelinquishOutput(ctx, auth, args)
}

// ListCertificates retrieves a paginated list of certificates based on the provided filter and pagination arguments.
func (m *WalletStorageManager) ListCertificates(ctx context.Context, args wdk.ListCertificatesArgs) (*wdk.ListCertificatesResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveReader().ListCertificates(ctx, auth, args)
}

// ListOutputs retrieves a list of wallet outputs based on the provided query parameters in the arguments.
func (m *WalletStorageManager) ListOutputs(ctx context.Context, args wdk.ListOutputsArgs) (*wdk.ListOutputsResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveReader().ListOutputs(ctx, auth, args)
}

// ListActions retrieves a list of wallet actions based on the provided query parameters in the arguments.
func (m *WalletStorageManager) ListActions(ctx context.Context, args wdk.ListActionsArgs) (*wdk.ListActionsResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveReader().ListActions(ctx, auth, args)
}

// AbortAction aborts a transaction that is in progress and has not yet been finalized or sent to the network.
func (m *WalletStorageManager) AbortAction(ctx context.Context, args wdk.AbortActionArgs) (*wdk.AbortActionResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveWriter().AbortAction(ctx, auth, args)
}

// FindOutputBasketsAuth finds output baskets for the authenticated user based on the provided filters.
func (m *WalletStorageManager) FindOutputBasketsAuth(ctx context.Context, filters wdk.FindOutputBasketsArgs) (wdk.TableOutputBaskets, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return wdk.TableOutputBaskets{}, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveReader().FindOutputBasketsAuth(ctx, auth, filters)
}

// FindOutputsAuth finds outputs for the authenticated user based on the provided filters.
func (m *WalletStorageManager) FindOutputsAuth(ctx context.Context, filters wdk.FindOutputsArgs) (wdk.TableOutputs, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return wdk.TableOutputs{}, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveReader().FindOutputsAuth(ctx, auth, filters)
}

// ListTransactions retrieves a list of transactions with their status updates for the authenticated user.
func (m *WalletStorageManager) ListTransactions(ctx context.Context, args wdk.ListTransactionsArgs) (*wdk.ListTransactionsResult, error) {
	auth, err := m.GetAuth(ctx)
	if err != nil {
		return nil, fmt.Errorf("failed to get user authentication: %w", err)
	}

	return m.getActiveReader().ListTransactions(ctx, auth, args)
}
