// Code generated by gorm.io/gen. DO NOT EDIT.
// Code generated by gorm.io/gen. DO NOT EDIT.
// Code generated by gorm.io/gen. DO NOT EDIT.

package genquery

import (
	"context"
	"database/sql"

	"gorm.io/gorm"

	"gorm.io/gen"

	"gorm.io/plugin/dbresolver"
)

func Use(db *gorm.DB, opts ...gen.DOOption) *Query {
	return &Query{
		db:                    db,
		Certificate:           newCertificate(db, opts...),
		ChaintracksBulkFile:   newChaintracksBulkFile(db, opts...),
		ChaintracksLiveHeader: newChaintracksLiveHeader(db, opts...),
		Commission:            newCommission(db, opts...),
		KnownTx:               newKnownTx(db, opts...),
		Label:                 newLabel(db, opts...),
		NumericIDLookup:       newNumericIDLookup(db, opts...),
		Output:                newOutput(db, opts...),
		OutputBasket:          newOutputBasket(db, opts...),
		OutputTag:             newOutputTag(db, opts...),
		Tag:                   newTag(db, opts...),
		Transaction:           newTransaction(db, opts...),
		TransactionLabel:      newTransactionLabel(db, opts...),
		TxNote:                newTxNote(db, opts...),
		User:                  newUser(db, opts...),
		UserUTXO:              newUserUTXO(db, opts...),
	}
}

type Query struct {
	db *gorm.DB

	Certificate           certificate
	ChaintracksBulkFile   chaintracksBulkFile
	ChaintracksLiveHeader chaintracksLiveHeader
	Commission            commission
	KnownTx               knownTx
	Label                 label
	NumericIDLookup       numericIDLookup
	Output                output
	OutputBasket          outputBasket
	OutputTag             outputTag
	Tag                   tag
	Transaction           transaction
	TransactionLabel      transactionLabel
	TxNote                txNote
	User                  user
	UserUTXO              userUTXO
}

func (q *Query) Available() bool { return q.db != nil }

func (q *Query) clone(db *gorm.DB) *Query {
	return &Query{
		db:                    db,
		Certificate:           q.Certificate.clone(db),
		ChaintracksBulkFile:   q.ChaintracksBulkFile.clone(db),
		ChaintracksLiveHeader: q.ChaintracksLiveHeader.clone(db),
		Commission:            q.Commission.clone(db),
		KnownTx:               q.KnownTx.clone(db),
		Label:                 q.Label.clone(db),
		NumericIDLookup:       q.NumericIDLookup.clone(db),
		Output:                q.Output.clone(db),
		OutputBasket:          q.OutputBasket.clone(db),
		OutputTag:             q.OutputTag.clone(db),
		Tag:                   q.Tag.clone(db),
		Transaction:           q.Transaction.clone(db),
		TransactionLabel:      q.TransactionLabel.clone(db),
		TxNote:                q.TxNote.clone(db),
		User:                  q.User.clone(db),
		UserUTXO:              q.UserUTXO.clone(db),
	}
}

func (q *Query) ReadDB() *Query {
	return q.ReplaceDB(q.db.Clauses(dbresolver.Read))
}

func (q *Query) WriteDB() *Query {
	return q.ReplaceDB(q.db.Clauses(dbresolver.Write))
}

func (q *Query) ReplaceDB(db *gorm.DB) *Query {
	return &Query{
		db:                    db,
		Certificate:           q.Certificate.replaceDB(db),
		ChaintracksBulkFile:   q.ChaintracksBulkFile.replaceDB(db),
		ChaintracksLiveHeader: q.ChaintracksLiveHeader.replaceDB(db),
		Commission:            q.Commission.replaceDB(db),
		KnownTx:               q.KnownTx.replaceDB(db),
		Label:                 q.Label.replaceDB(db),
		NumericIDLookup:       q.NumericIDLookup.replaceDB(db),
		Output:                q.Output.replaceDB(db),
		OutputBasket:          q.OutputBasket.replaceDB(db),
		OutputTag:             q.OutputTag.replaceDB(db),
		Tag:                   q.Tag.replaceDB(db),
		Transaction:           q.Transaction.replaceDB(db),
		TransactionLabel:      q.TransactionLabel.replaceDB(db),
		TxNote:                q.TxNote.replaceDB(db),
		User:                  q.User.replaceDB(db),
		UserUTXO:              q.UserUTXO.replaceDB(db),
	}
}

type queryCtx struct {
	Certificate           ICertificateDo
	ChaintracksBulkFile   IChaintracksBulkFileDo
	ChaintracksLiveHeader IChaintracksLiveHeaderDo
	Commission            ICommissionDo
	KnownTx               IKnownTxDo
	Label                 ILabelDo
	NumericIDLookup       INumericIDLookupDo
	Output                IOutputDo
	OutputBasket          IOutputBasketDo
	OutputTag             IOutputTagDo
	Tag                   ITagDo
	Transaction           ITransactionDo
	TransactionLabel      ITransactionLabelDo
	TxNote                ITxNoteDo
	User                  IUserDo
	UserUTXO              IUserUTXODo
}

func (q *Query) WithContext(ctx context.Context) *queryCtx {
	return &queryCtx{
		Certificate:           q.Certificate.WithContext(ctx),
		ChaintracksBulkFile:   q.ChaintracksBulkFile.WithContext(ctx),
		ChaintracksLiveHeader: q.ChaintracksLiveHeader.WithContext(ctx),
		Commission:            q.Commission.WithContext(ctx),
		KnownTx:               q.KnownTx.WithContext(ctx),
		Label:                 q.Label.WithContext(ctx),
		NumericIDLookup:       q.NumericIDLookup.WithContext(ctx),
		Output:                q.Output.WithContext(ctx),
		OutputBasket:          q.OutputBasket.WithContext(ctx),
		OutputTag:             q.OutputTag.WithContext(ctx),
		Tag:                   q.Tag.WithContext(ctx),
		Transaction:           q.Transaction.WithContext(ctx),
		TransactionLabel:      q.TransactionLabel.WithContext(ctx),
		TxNote:                q.TxNote.WithContext(ctx),
		User:                  q.User.WithContext(ctx),
		UserUTXO:              q.UserUTXO.WithContext(ctx),
	}
}

func (q *Query) DBTransaction(fc func(tx *Query) error, opts ...*sql.TxOptions) error {
	return q.db.Transaction(func(tx *gorm.DB) error { return fc(q.clone(tx)) }, opts...)
}

func (q *Query) Begin(opts ...*sql.TxOptions) *QueryTx {
	tx := q.db.Begin(opts...)
	return &QueryTx{Query: q.clone(tx), Error: tx.Error}
}

type QueryTx struct {
	*Query
	Error error
}

func (q *QueryTx) Commit() error {
	return q.db.Commit().Error
}

func (q *QueryTx) Rollback() error {
	return q.db.Rollback().Error
}

func (q *QueryTx) SavePoint(name string) error {
	return q.db.SavePoint(name).Error
}

func (q *QueryTx) RollbackTo(name string) error {
	return q.db.RollbackTo(name).Error
}
