// Code generated by client-gen; DO NOT EDIT.

package server

import (
	"context"
	"fmt"
)

import "github.com/bsv-blockchain/go-wallet-toolbox/pkg/wdk"

// Migrate migrates a wallet storage database.
func (p *RPCStorageProvider) Migrate(ctx context.Context, storageName string, storageIdentityKey string) (string, error) {
	return "", fmt.Errorf("method not allowed to be called via RPC")
}

// MakeAvailable makes the storage available storage for user.
func (p *RPCStorageProvider) MakeAvailable(ctx context.Context) (*wdk.TableSettings, error) {
	err := p.verifyAuthenticated(ctx)
	if err != nil {
		return nil, err
	}

	return p.localProvider.MakeAvailable(ctx)
}

// SetActive updates the active storage identity key for the authenticated user.
func (p *RPCStorageProvider) SetActive(ctx context.Context, auth wdk.AuthID, newActiveStorageIdentityKey string) error {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return err
	}

	return p.localProvider.SetActive(ctx, auth, newActiveStorageIdentityKey)
}

// InternalizeAction handles the internalization of a transaction from the outside of the wallet.
func (p *RPCStorageProvider) InternalizeAction(ctx context.Context, auth wdk.AuthID, args wdk.InternalizeActionArgs) (*wdk.InternalizeActionResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.InternalizeAction(ctx, auth, args)
}

// CreateAction creates a new transaction ready to be signed and processed later.
func (p *RPCStorageProvider) CreateAction(ctx context.Context, auth wdk.AuthID, args wdk.ValidCreateActionArgs) (*wdk.StorageCreateActionResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.CreateAction(ctx, auth, args)
}

// ProcessAction processes a signed transaction created by CreateAction.
func (p *RPCStorageProvider) ProcessAction(ctx context.Context, auth wdk.AuthID, args wdk.ProcessActionArgs) (*wdk.ProcessActionResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.ProcessAction(ctx, auth, args)
}

// InsertCertificateAuth adds a new certificate for a user.
func (p *RPCStorageProvider) InsertCertificateAuth(ctx context.Context, auth wdk.AuthID, certificate *wdk.TableCertificateX) (uint, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return 0, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return 0, err
	}

	return p.localProvider.InsertCertificateAuth(ctx, auth, certificate)
}

// RelinquishCertificate revokes the specified certificate from the users certificates.
func (p *RPCStorageProvider) RelinquishCertificate(ctx context.Context, auth wdk.AuthID, args wdk.RelinquishCertificateArgs) error {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return err
	}

	return p.localProvider.RelinquishCertificate(ctx, auth, args)
}

// RelinquishOutput removes the specified output from the users outputs.
func (p *RPCStorageProvider) RelinquishOutput(ctx context.Context, auth wdk.AuthID, args wdk.RelinquishOutputArgs) error {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return err
	}

	return p.localProvider.RelinquishOutput(ctx, auth, args)
}

// ListCertificates retrieves a paginated list of certificates based on the provided filter and pagination arguments.
func (p *RPCStorageProvider) ListCertificates(ctx context.Context, auth wdk.AuthID, args wdk.ListCertificatesArgs) (*wdk.ListCertificatesResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.ListCertificates(ctx, auth, args)
}

// ListOutputs retrieves a list of wallet outputs based on the provided query parameters in the arguments.
func (p *RPCStorageProvider) ListOutputs(ctx context.Context, auth wdk.AuthID, args wdk.ListOutputsArgs) (*wdk.ListOutputsResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.ListOutputs(ctx, auth, args)
}

// ListActions retrieves a list of wallet actions based on the provided query parameters in the arguments.
func (p *RPCStorageProvider) ListActions(ctx context.Context, auth wdk.AuthID, args wdk.ListActionsArgs) (*wdk.ListActionsResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.ListActions(ctx, auth, args)
}

// GetSyncChunk retrieves a chunk of sync data for a user between two storages using the provided synchronization arguments.
// Skipped in WalletStorage interface and not exposed in StorageManager.
func (p *RPCStorageProvider) GetSyncChunk(ctx context.Context, args wdk.RequestSyncChunkArgs) (*wdk.SyncChunk, error) {
	err := p.verifyAuthenticated(ctx)
	if err != nil {
		return nil, err
	}

	return p.localProvider.GetSyncChunk(ctx, args)
}

// FindOrInsertSyncStateAuth retrieves an existing sync state or inserts a new one based on the provided authentication and storage details.
// Skipped in WalletStorage interface and not exposed in StorageManager.
func (p *RPCStorageProvider) FindOrInsertSyncStateAuth(ctx context.Context, auth wdk.AuthID, storageIdentityKey string, storageName string) (*wdk.FindOrInsertSyncStateAuthResponse, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.FindOrInsertSyncStateAuth(ctx, auth, storageIdentityKey, storageName)
}

// ProcessSyncChunk processes a sync chunk for a user, applying the changes contained within it.
// Skipped in WalletStorage interface and not exposed in StorageManager.
func (p *RPCStorageProvider) ProcessSyncChunk(ctx context.Context, args wdk.RequestSyncChunkArgs, chunk *wdk.SyncChunk) (*wdk.ProcessSyncChunkResult, error) {
	err := p.verifyAuthenticated(ctx)
	if err != nil {
		return nil, err
	}

	return p.localProvider.ProcessSyncChunk(ctx, args, chunk)
}

// AbortAction aborts a transaction that is in progress and has not yet been finalized or sent to the network.
func (p *RPCStorageProvider) AbortAction(ctx context.Context, auth wdk.AuthID, args wdk.AbortActionArgs) (*wdk.AbortActionResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.AbortAction(ctx, auth, args)
}

// FindOutputBasketsAuth finds output baskets for the authenticated user based on the provided filters.
func (p *RPCStorageProvider) FindOutputBasketsAuth(ctx context.Context, auth wdk.AuthID, filters wdk.FindOutputBasketsArgs) (wdk.TableOutputBaskets, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return wdk.TableOutputBaskets{}, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return wdk.TableOutputBaskets{}, err
	}

	return p.localProvider.FindOutputBasketsAuth(ctx, auth, filters)
}

// FindOutputsAuth finds outputs for the authenticated user based on the provided filters.
func (p *RPCStorageProvider) FindOutputsAuth(ctx context.Context, auth wdk.AuthID, filters wdk.FindOutputsArgs) (wdk.TableOutputs, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return wdk.TableOutputs{}, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return wdk.TableOutputs{}, err
	}

	return p.localProvider.FindOutputsAuth(ctx, auth, filters)
}

// ListTransactions retrieves a list of transactions with their status updates for the authenticated user.
func (p *RPCStorageProvider) ListTransactions(ctx context.Context, auth wdk.AuthID, args wdk.ListTransactionsArgs) (*wdk.ListTransactionsResult, error) {
	err := p.verifyAuthID(ctx, auth)
	if err != nil {
		return nil, err
	}
	err = p.ensureUserID(ctx, &auth)
	if err != nil {
		return nil, err
	}

	return p.localProvider.ListTransactions(ctx, auth, args)
}
